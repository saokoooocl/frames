<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Matias - Fondo Animado</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lobster&family=Orbitron&display=swap" rel="stylesheet">
    <style>
        body{background:linear-gradient(-45deg,#FFD700,#F0E68C,#B8860B,#DAA520);background-size:400% 400%;animation:gradientBG 15s ease infinite;margin:0;display:flex;justify-content:center;align-items:center;height:100vh;overflow:hidden;font-family:'Lobster',cursive}#number-rain{position:fixed;top:0;left:0;width:100%;height:100%;z-index:1;pointer-events:none;overflow:hidden}.number{position:absolute;top:-50px;color:rgba(0,0,0,.3);animation:fall linear infinite;writing-mode:vertical-rl;text-orientation:mixed;font-family:monospace}@keyframes fall{to{transform:translateY(105vh)}}@keyframes gradientBG{0%{background-position:0 50%}50%{background-position:100% 50%}100%{background-position:0 50%}}.content-container{position:relative;z-index:2;display:flex;flex-direction:column;align-items:center;text-align:center;padding:2rem 4rem;border-radius:20px}.animated-text{display:flex}.animated-text span{font-size:18rem;color:#fff;text-shadow:3px 3px 0 #4E342E,6px 6px 0 #6B4F4B,9px 9px 8px rgba(0,0,0,.5);animation:pulseEffect 3s ease-in-out infinite;position:relative}.subtitle{font-size:2rem;color:#FFF8E7;margin-top:1rem;text-shadow:2px 2px 4px #4E342E;letter-spacing:.1em;text-transform:uppercase;font-family:'Orbitron',sans-serif;white-space:nowrap;min-height:2.5rem}.subtitle::after{content:'▋';margin-left:.2em;color:#FFF8E7;animation:blink .7s infinite step-end}@keyframes blink{50%{opacity:0}}.subtitle.typing-finished::after{animation:none;content:''}@keyframes pulseEffect{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}.animated-text span:nth-child(1){animation-delay:0s}.animated-text span:nth-child(2){animation-delay:-.2s}.animated-text span:nth-child(3){animation-delay:-.4s}.animated-text span:nth-child(4){animation-delay:-.6s}.animated-text span:nth-child(5){animation-delay:-.8s}.animated-text span:nth-child(6){animation-delay:-1s}.visitor-info{position:fixed;top:15px;right:15px;z-index:10;background:rgba(0,0,0,.5);color:#FFF8E7;padding:10px 15px;border-radius:10px;font-family:'Orbitron',sans-serif;font-size:.8rem;text-align:right;box-shadow:0 0 10px rgba(0,0,0,.5);border:1px solid rgba(255,255,255,.2);backdrop-filter:blur(5px)}.visitor-info p{margin:5px 0}.visitor-info strong{color:#FFD700;margin-right:8px}@media (max-width:768px){.animated-text span{font-size:10rem}.content-container{padding:1rem 2rem}.subtitle{font-size:1.1rem;min-height:1.5rem}}@media (max-width:480px){.animated-text span{font-size:6rem}.subtitle{font-size:.7rem;min-height:1rem}.visitor-info{font-size:.6rem;padding:5px 8px}.visitor-info strong{margin-right:5px}}
    </style>
</head>
<body>
    <div id="number-rain"></div>

    <div class="content-container">
        <div class="animated-text">
            <span>M</span><span>a</span><span>t</span><span>i</span><span>a</span><span>s</span>
        </div>
        <div id="subtitle" class="subtitle">venta de radios , xatspace y aplicaciones web</div>
    </div>

    <div class="visitor-info">
        <p><strong>IP:</strong><span id="ip-address">Cargando...</span></p>
        <p><strong>Ubicación:</strong><span id="location">Cargando...</span></p>
        <p><strong>Visitas:</strong><span id="visitor-counter-span"></span></p>
    </div>

    <script type="module">
        // Importaciones de Firebase
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        
        // --- Configuración Manual de Firebase ---
        // Esta configuración debe ser la misma que la del panel.
        const firebaseConfig = {
            apiKey: "AIzaSyAoRKxUkAqeZy4Cgmry2x_5AzGBbde6kIE",
            authDomain: "stream-b81ba.firebaseapp.com",
            projectId: "stream-b81ba",
            storageBucket: "stream-b81ba.firebasestorage.app",
            messagingSenderId: "77635617548",
            appId: "1:77635617548:web:750a282f11c41ed568ff29"
        };
        
        let db;

        // --- Inicialización de Firebase ---
        async function initFirebase() {
            try {
                if (firebaseConfig && firebaseConfig.apiKey) {
                    const app = initializeApp(firebaseConfig);
                    db = getFirestore(app);
                    const auth = getAuth(app);
                    await signInAnonymously(auth);
                    return true;
                }
            } catch (error) {
                console.error("Error al inicializar Firebase:", error);
            }
            return false;
        }

        // --- Guardar información en Firestore ---
        async function saveVisitorInfo(info) {
            if (!db) {
                console.log("La base de datos no está inicializada. No se puede guardar la visita.");
                return;
            }
            try {
                 // Ruta simplificada para la colección de visitantes
                const visitorsCollection = collection(db, 'visitors');
                const visitorData = {
                    ip: info.ip || 'No disponible',
                    location: info.location || 'No disponible',
                    timestamp: serverTimestamp() // Fecha y hora del servidor
                };
                await addDoc(visitorsCollection, visitorData);
            } catch (error) {
                console.error("Error al guardar la visita en Firestore:", error);
            }
        }


        document.addEventListener('DOMContentLoaded', () => {
            const rainContainer = document.getElementById('number-rain');
            for (let i = 0; i < 60; i++) {
                const numberEl=document.createElement('span');numberEl.classList.add('number');numberEl.textContent='15051993';numberEl.style.left=`${Math.random()*100}vw`;numberEl.style.animationDuration=`${Math.random()*5+4}s`;numberEl.style.animationDelay=`${Math.random()*6}s`;numberEl.style.fontSize=`${Math.random()*1.5+.8}em`;numberEl.style.opacity=Math.random()*.5+.2;rainContainer.appendChild(numberEl)
            }

            const subtitleEl=document.getElementById('subtitle'),textToType=subtitleEl.textContent;let i=0;subtitleEl.textContent='';function typeWriter(){if(i<textToType.length){subtitleEl.textContent+=textToType.charAt(i);i++;setTimeout(typeWriter,120)}else{setTimeout(()=>{subtitleEl.classList.add('typing-finished')},1500)}}
            setTimeout(typeWriter,500);

            async function getVisitorInfo() {
                const ipEl = document.getElementById('ip-address');
                const locationEl = document.getElementById('location');
                try {
                    const response = await fetch('https://ipinfo.io/json');
                    if (!response.ok) throw new Error('La respuesta de la red no fue correcta.');
                    const data = await response.json();
                    const locationString = `${data.city || ''}, ${data.country || ''}`;
                    ipEl.textContent = data.ip || 'No disponible';
                    locationEl.textContent = locationString;

                    // Guardar la información después de obtenerla
                    saveVisitorInfo({ ip: data.ip, location: locationString });

                } catch (error) {
                    console.error('Error al obtener la información del visitante:', error);
                    ipEl.textContent = 'No disponible';
                    locationEl.textContent = 'No disponible';
                }
            }

            function loadVisitorCounter() {
                const counterSpan=document.getElementById('visitor-counter-span'),counterLink=document.createElement('a');counterLink.href="https://www.hitwebcounter.com";counterLink.target="_blank";const counterImg=document.createElement('img');counterImg.src="https://hitwebcounter.com/counter/counter.php?page=12398710&style=0007&nbdigits=6&type=page&initCount=0";counterImg.title="Contador de Visitas";counterImg.alt="Contador de Visitas";counterImg.style.border='0';counterLink.appendChild(counterImg);counterSpan.appendChild(counterLink)
            }
            
            async function main() {
                await initFirebase();
                getVisitorInfo();
                loadVisitorCounter();
            }

            main();
        });
    </script>
</body>
</html>

